"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var PropertySet_1 = require("../property/PropertySet");
var utils_1 = require("../utils");
var GUIDStream = /** @class */ (function () {
    function GUIDStream(stream) {
        this.stream = stream;
    }
    GUIDStream.prototype.getGuidAt = function (index) {
        if (index === 1) {
            return PropertySet_1.PropertySet.PS_MAPI.id;
        }
        else if (index === 2) {
            return PropertySet_1.PropertySet.PUBLIC_STRINGS.id;
        }
        else {
            return utils_1.uuidFromByteLE(this.getGuidBytes(index));
        }
    };
    GUIDStream.prototype.getGuidBytes = function (index) {
        if (index === 1 || index === 2) {
            throw new Error("Not implemented property type: PS_MAPI or PS_PUBLIC_STRINGS (" + index + ")");
        }
        var position = index - GUIDStream.MAGICAL_SHIFT_INSIDE_STREAM;
        return this.stream.read(position * GUIDStream.GUID_LENGTH, (position + 1) * GUIDStream.GUID_LENGTH);
    };
    GUIDStream.prototype.getIndexFor = function (uid) {
        for (var i = 3; i < 3 + this.stream.getStreamSize() / 16; i++) {
            var bytes = this.getGuidBytes(i);
            if (uid.equal(utils_1.uuidFromByteLE(bytes))) {
                return i;
            }
        }
        return -1;
    };
    GUIDStream.STREAM_NAME = "__substg1.0_00020102";
    GUIDStream.MAGICAL_SHIFT_INSIDE_STREAM = 3;
    GUIDStream.GUID_LENGTH = 16;
    return GUIDStream;
}());
exports.GUIDStream = GUIDStream;
//# sourceMappingURL=GuidStream.js.map